<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Pinellas Precinct Map</title>
    <link rel="stylesheet" href="leaflet.css" />
    <script src="leaflet.js" ></script>
  </head>
  <body>




    <!-- Create map (standard, requires set height) -->
    <div id='map' style='width: 100%; height: 500px;'></div>

    <!-- Load state geoJSON (standard) -->
    <script type="text/javascript" src="precinctsDataMunDist.js"></script>

    <!-- Load state data JSON (custom) -->
    <script type="text/javascript" src="data.js"></script>

    <script type="text/javascript" src="municipalities.js"></script>

    <!-- Load chroma -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>

    <!-- Load custom color picker, default with TBT green, orange and white -->
    <script type="text/javascript" src="chromacolors.js"></script>
    <script>

      // Set US map.
      var usmap = L.map('map', {
        zoomSnap: 0.25
      }).setView([27.912390, -82.749999], 10);

      // Load mapbox tile, add to map
      L.tileLayer('https://api.mapbox.com/styles/v1/ltaylor11/cj9hhab6o9wc22rs28d6o82x3/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoibHRheWxvcjExIiwiYSI6ImNqOWhndGV0cjJ6ZmIyeHBhMzVqbG42d2kifQ.PDNpdxh13YZxmaQWEqQTSg', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>'
      }).addTo(usmap);


      // Go through data.js, attach values to geoJSON data
      // for (var i = 0; i < data.length; i++) {
      //   var tempState = data[i];
      //   for (var j = 0; j < statesData.features.length; j++) {
      //     if (tempState.state == statesData.features[j].properties.NAME) {
      //       statesData.features[j].properties.value=tempState.tps3_rate;
      //     }
      //   }
      // }

      // Pick color scale and domain
      // var cscale=pickScale('gray-white-brightOrange');

      // pickDomain(data, [choice]). [choice] accepts numbers or 'min' or 'max'. number of entries should correspond to number of color steps in pickScale
      // cscale.domain(pickDomain(statesData.features,[0,0.000000000000001,'max']));

      // L.geoJson(statesData).addTo(usmap);
      function  style(feature) {
        return {
          fillColor: 'black', //cscale(feature.properties.value),
          fillOpacity: 0.8,
          color: 'white',//pickColor('white'),
          weight: 1.5,
          opacity: 0.5
        };
      }

      // for (var i = 0; i < stp.length; i++) {
      //   for (var j = 0; j < precinctsData.features.length; j++) {
      //     if (stp[i].toString()==precinctsData.features[j].properties.PRECINCTID) {
      //       precinctsData.features[j].properties.municipality={};
      //       precinctsData.features[j].properties.municipality.name="St. Petersburg";
      //     }
      //   }
      // }
      //
      // for (var i = 1; i < stpdistricts.length; i++) {
      //   for (var j = 0; j < stpdistricts[i].length; j++) {
      //     for (var k = 0; k < precinctsData.features.length; k++) {
      //       if (stpdistricts[i][j].toString()==precinctsData.features[k].properties.PRECINCTID) {
      //         precinctsData.features[k].properties.municipality.district=i;
      //       }
      //     }
      //   }
      // }
      //
      // function download(text, name, type) {
      //     var a = document.createElement("a");
      //     var file = new Blob([text], {type: type});
      //     a.href = URL.createObjectURL(file);
      //     a.download = name;
      //     a.click();
      // }
      // download(JSON.stringify(precinctsData), 'precinctsDataMunDist.txt', 'text/plain');


      L.geoJson(precinctsData.features, {style: style}).addTo(usmap);

    </script>


  </body>
</html>
